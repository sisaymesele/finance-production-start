
{% extends "dashboard.html" %}

{% block content %}
<!-- Back Button -->
<div class="mb-3">
    <a href="{{ back_url }}"
       class="btn btn-secondary"
       hx-get="{{ back_url }}"
       hx-target="#full-page-container"
       hx-swap="innerHTML"
       hx-push-url="true">
        ‚Üê Back to Regular Payroll List
    </a>
</div>

<!-- Centered Form Container -->
<div class="d-flex justify-content-center">
    <div class="p-2 border rounded shadow-lg bg-white" style="width: 80%;" id="form-container">

        <!-- Title -->
        <div class="mb-3 text-center">
            <h4 class="mb-0">{{ form_title }}</h4>
            {% if form_description %}
            <small class="text-muted">{{ form_description }}</small>
            {% endif %}
        </div>

        <!-- Form Errors -->
        {% if form.errors %}
        <div class="alert alert-danger">
            <ul class="mb-0">
                {% for field in form %}
                {% for error in field.errors %}
                <li><strong>{{ field.label }}:</strong> {{ error }}</li>
                {% endfor %}
                {% endfor %}
                {% for error in form.non_field_errors %}
                <li>{{ error }}</li>
                {% endfor %}
            </ul>
        </div>
        {% endif %}

        <!-- Form -->
        <form method="POST"
              {% if edit_regular_payroll %}
              hx-post="{% url 'update_regular_payroll' payroll_month.slug edit_regular_payroll.pk %}"
              {% else %}
              hx-post="{% url 'create_regular_payroll' payroll_month_slug %}"
              {% endif %}
              hx-target="#full-page-container"
              hx-swap="innerHTML"
              hx-push-url="true">

            {% csrf_token %}

            <!-- Optional Add Personnel Section -->
            {% if show_add_personnel %}
            <div class="mb-4 d-flex justify-content-end">
                <div class="d-flex align-items-center gap-3">
                    <h6 class="mb-0">If no personnel below:</h6>
                    <a href="{% url 'create_personnel' %}?next={{ current_url }}"
                       class="btn btn-primary"
                       hx-get="{% url 'create_personnel' %}?next={{ current_url }}"
                       hx-target="#full-page-container"
                       hx-swap="innerHTML"
                       hx-push-url="true">
                        + Add New Personnel
                    </a>
                </div>
            </div>
            {% endif %}

            <!-- Form Fields -->
            <div class="mb-3">
                {{ form.as_p }}
            </div>

            <!-- Submit Button -->
            <div class="text-end">
                <button class="btn btn-dark" type="submit">
                    {{ submit_button_text|default:"Submit" }}
                </button>
            </div>
        </form>
    </div>
</div>
{% endblock %}
